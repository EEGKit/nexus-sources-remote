version: "3.7"

services:

  main:
    container_name: nexus-main
    image: mcr.microsoft.com/dotnet/sdk:6.0
    volumes:
      - /var/lib/nexus/docker/nexus-main/.ssh:/root/.ssh
    entrypoint: bash -c "cd; curl -s -O 'https://raw.githubusercontent.com/Nexusforge/nexus-sources-remote/main/setup/docker/setup-main.sh'; source 'setup-main.sh'"
    restart: always

  satellite:
    container_name: nexus-${satellite_id}
    image: ${satellite_image}
    volumes:
      - /var/lib/nexus/docker/nexus-${satellite_id}/.ssh:/root/.ssh
    entrypoint: bash -c "satellite_id=${satellite_id};cd; curl -s -O 'https://raw.githubusercontent.com/Nexusforge/nexus-sources-remote/main/setup/docker/setup-satellite.sh'; source 'setup-satellite.sh'"
    restart: always
